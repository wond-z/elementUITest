<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <!-- <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/jQuery.print/1.6.2/jQuery.print.min.js"></script> -->
    <link rel="stylesheet" href="./lib/element-ui/lib/theme-chalk/index.css" />
    <script src="./lib/vue.min.js"></script>
    <script src="./lib/element-ui/lib/index.js"></script>
    <script src="./lib/FileSaver.min.js"></script>
    <script src="./lib/xlsx.full.min.js"></script>
    <script src="./lib/jquery.min.js"></script>
    <script src="./lib/jQuery.print.min.js"></script>

    <style type="text/css">
        .el-scrollbar__wrap {
            overflow-x: hidden;
        }
    </style>
</head>

<body>
    <div id="app">
        <el-table ref="report-table" :data="tableData" style="width: 100%">
            <el-table-column prop="date" label="日期" width="150"></el-table-column>
            <el-table-column prop="name" label="姓名" width="120"></el-table-column>
            <el-table-column prop="province" label="省份" width="120"></el-table-column>
            <el-table-column prop="city" label="市区" width="120"></el-table-column>
            <el-table-column prop="address" label="地址" width="300"></el-table-column>
            <el-table-column prop="address" label="地址" width="300"></el-table-column>
            <el-table-column prop="address" label="地址" width="300"></el-table-column>
            <el-table-column prop="address" label="地址" width="300"></el-table-column>
            <el-table-column prop="zip" label="邮编" width="120"></el-table-column>
                
            
        </el-table>
        <el-button @click="exportExcel(123)">导出</el-button>
    </div>
    <script>
    new Vue({
        el: '#app',
        data() {
            return {
                tableData: [{
                    date: '2016-05-03',
                    name: '王小虎',
                    province: '上海',
                    city: '普陀区',
                    address: '上海市普陀区金沙江路 1518 弄',
                    zip: 200333
                }, {
                    date: '2016-05-02',
                    name: '王小虎',
                    province: '上海',
                    city: '普陀区',
                    address: '上海市普陀区金死灵法师地方就是翻开历史记录方式沙江路 1518 弄',
                    zip: 200333
                }, {
                    date: '2016-05-04',
                    name: '王小虎',
                    province: '上海',
                    city: '普陀区',
                    address: '上海市普陀随风倒士大夫胜多负少发射点发射点区金沙江路 1518 弄',
                    zip: 200333
                }, {
                    date: '2016-05-01',
                    name: '王小虎',
                    province: '上海',
                    city: '普陀区',
                    address: '上海市普陀区金士大夫首发式地方十分士大夫士大夫沙江路 1518 弄',
                    zip: 200333
                }, {
                    date: '2016-05-08',
                    name: '王小虎',
                    province: '上海',
                    city: '普陀区',
                    address: '上海市普陀区金沙江路 1518 弄',
                    zip: 200333
                }, {
                    date: '2016-05-06',
                    name: '王小虎',
                    province: '上海',
                    city: '普陀区',
                    address: '上海市普陀区金沙江路 1518 弄',
                    zip: 200333
                }, {
                    date: '2016-05-07',
                    name: '王小虎',
                    province: '上海',
                    city: '普陀区',
                    address: '上海市普陀区金沙江路 1518 弄',
                    zip: 200333
                }]
            }
        },
        components: {

        },
        watch: {

        },
        methods: {
            exportExcel(excelName) {
                // try {
                //     const $e = this.$refs['report-table'].$el;
                //     let $table = $e.querySelector('.el-table__fixed');
                //     if (!$table) {
                //         $table = $e;
                //     }

                //     const wb = XLSX.utils.table_to_book($table, { raw: true })
                //     const wbout = XLSX.write(wb, { bookType: 'xlsx', bookSST: true, type: 'array' })
                //     saveAs(
                //         new Blob([wbout], { type: 'application/octet-stream' }),
                //         `${excelName}.xlsx`,
                //     )
                // } catch (e) {
                //     if (typeof console !== 'undefined') console.error(e)
                // }
                $('#app').width($('#app').width());
                $("#app").print({
                    globalStyles:true,//是否包含父文档的样式，默认为true
                    mediaPrint:false,//是否包含media='print'的链接标签。会被globalStyles选项覆盖，默认为false
                    stylesheet:null,//外部样式表的URL地址，默认为null

                    noPrintSelector:".no-print",//不想打印的元素的jQuery选择器，默认为".no-print"
                    iframe:true,//是否使用一个iframe来替代打印表单的弹出窗口，true为在本页面进行打印，false就是说新开一个页面打印，默认为true
                    append:null,//将内容添加到打印内容的后面
                    prepend:null,//将内容添加到打印内容的前面，可以用来作为要打印内容
                    deferred: $.Deferred()//回调函数
                });
            }
        },
        mounted() {}
    })
    </script>
</body>

</html>